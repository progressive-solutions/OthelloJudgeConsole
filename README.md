# 🤖 OthelloJudgeConsole

## 概要

`OthelloJudgeConsole` は、外部の AI プログラム（思考エンジン）を起動し、コマンドライン（CUI）上でオセロの対戦を自動で管理・実行するための審判プログラムです。新人研修における AI アルゴリズム開発のプラットフォームとして設計されています。

このジャッジは、以下のルールに基づいて AI プログラムの勝敗を判定します。

1.  **通信プロトコル:** 標準入出力（stdin/stdout）を使用。
2.  **無効手:** 合法手ではない座標を返した場合、その AI は**敗北**となります。
3.  **タイムアウト:** 5 秒以内に着手を返さなかった場合、その AI は**敗北**となります。

---

## 🚀 動作環境とセットアップ

### 必須環境

- Java Development Kit (JDK) 8 以上
- ターミナル (chcp 65001 / UTF-8 が利用可能な環境を推奨)

### ファイル構成

プロジェクトは以下の 3 つのファイルで構成されます。

| ファイル名                 | 役割                                                             | 備考                   |
| :------------------------- | :--------------------------------------------------------------- | :--------------------- |
| `OthelloJudgeConsole.java` | **審判本体**。ゲームの進行管理と AI との通信、勝敗判定。         | 実行するメインファイル |
| `GameEngine.java`          | オセロの**ゲームルール**（合法手判定、反転処理）を管理。         |                        |
| `AIPlayerAdapter.java`     | 外部 AI プロセスとの**通信とタイムアウト監視**を担うアダプター。 |                        |

### 実行手順

1.  **全ファイルのコンパイルと実行可能 JAR ファイルの生成**

    ```bash
    mkdir -p classes
    javac -d classes -source 21 -target 21 *.java;    jar cvfm bin/OthelloJudgeConsole.jar Manifest.txt -C classes .
    ```

2.  **ジャッジの起動**
    AI プログラムのファイルパスを入力し、対戦を開始します。

    ```bash
    java -jar OthelloJudgeConsole.jar
    ```

---

## 🤝 AI プログラム通信プロトコル仕様

本プロトコルは、AI プログラムが思考の実装に集中できるよう、**標準入出力（stdin/stdout）**を利用したシンプルなコマンド形式で設計されています。

---

### 1. 📥 ジャッジプログラムから AI への入力 (標準入力)

AI プログラムは、ジャッジプログラムから以下の 3 種類のコマンドを 1 行ずつ受け取ります。

### 1.1. 初期設定コマンド: `COLOR`

対局開始時に、AI が担当する石の色を通知します。

| 形式               | 例        | 説明                       |
| :----------------- | :-------- | :------------------------- |
| `COLOR [色コード]` | `COLOR 1` | 自身の石の色を通知します。 |

| 色コード | 意味             |
| :------- | :--------------- |
| **`1`**  | **黒石 (BLACK)** |
| **`2`**  | **白石 (WHITE)** |

例：白番

```
COLOR 1
```

### 1.2. 手番通知コマンド: `MOVE BOARD`

AI に思考を開始し、着手を決定するように指示します。現在の盤面情報が引数として渡されます。

| 形式                      | 例                     | 説明                                              |
| :------------------------ | :--------------------- | :------------------------------------------------ |
| `MOVE BOARD:[盤面文字列]` | `MOVE BOARD:000120...` | 思考開始を指示し、64 文字の盤面文字列を渡します。 |

#### 盤面文字列の詳細

盤面は、**行優先**で左上（a1）から右下（h8）までを並べた**64 文字**の文字列です。

| 文字    | 意味                 |
| :------ | :------------------- |
| **`0`** | **空きマス (EMPTY)** |
| **`1`** | **黒石 (BLACK)**     |
| **`2`** | **白石 (WHITE)**     |

> **例:** 最初の 4x4 エリア（d4, e4, d5, e5）が初期配置の場合の文字列表現。
>
> ```
> 000...0001200000021000...00000000
> ```

例：初手

```
COLOR 1
MOVE BOARD:0000000000000000000000000002100000012000000000000000000000000000
```

### 1.3. 終了コマンド: `QUIT`

対局が終了したことを通知します。

| 形式   | 例     | 説明                      |
| :----- | :----- | :------------------------ |
| `QUIT` | `QUIT` | AI プロセスを終了します。 |

---

## 2. 📤 AI から審判への出力 (標準出力)

AI プログラムは、`MOVE BOARD:`コマンドを受け取った後、**5 秒以内**に以下のいずれか 1 行のみを標準出力に返さなければなりません。

| 形式         | 例     | 意味                                                 |
| :----------- | :----- | :--------------------------------------------------- |
| **着手座標** | `c5`   | 小文字の列（a-h）と行番号（1-8）で構成される文字列。 |
| **パス**     | `pass` | 合法手がない場合。                                   |

例：e6

```
e6
```

---

## 3. 🚨 審判の判定ルール（AI 側の失敗）

以下の条件のいずれかを満たした場合、AI は対局に**敗北**し、相手 AI の勝利となります。

1.  **タイムアウト:** 5 秒以内に着手を返さなかった場合。
2.  **無効手:** 合法手ではない座標を返した場合、またはパスが不必要な局面でパスを返した場合。
3.  **不正な出力:** プロトコルで定められた形式以外の文字列を返した場合（デバッグメッセージなどの混入）。
